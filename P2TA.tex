\documentclass[a4paper,10pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{hyperref}

%opening
\title{Pay-to-TagAddress (P2TA): Tagging blockchain transactions for efficient queryability}
\author{Hans Robeers hrobeers@... twitter.com/hrobeers}

\begin{document}

\maketitle

\begin{abstract}
Multiple applications are using existing blockchains as a communication network.
Most of these implementations are scanning to blockchain for transactions matching their own format.
However, processing large blockchains to find application specific transactions can be expensive to execute.
This paper proposes a tagging mechanism, Pay-to-TagAddress (P2TA), that allows efficient lookup of application specific transactions based on the addition of transactions to deterministic tagged addresses.
\end{abstract}

\section{Introduction}
Blockchains, as first introduced by the Bitcoin\cite{Nak09} network, are used increasingly for non-currency applications.
Examples of non-currency usage includes Colored Coins\cite{Ros12}, PeerMessage\cite{Emeth}, PSA\cite{Pchem} and multiple others.
These applications typically publish there own specific messages in the form of OP\_RETURN transactions on a third-party blockchain.
Scanning an entire blockchain for messages of a specific form becomes increasingly expensive while the blockchain grows.
Applications like PeerMessage\cite{Emeth} only rely on real-time transactions being relayed by the network and therefore do not suffer from blockchain growth.
However, applications like PSA\cite{Pchem} need know an entire history of asset specific transactions to be able to validate asset ownership.
Therefore these type of applications would greatly benefit from a system that allows efficient querying of transactions holding a specific tag.

\section{Blockchain queryability}
Blockchain clients are designed to efficiently query for transactions, blocks and addresses by their hash values.
Therefore the client can be approached as if it's storing the blockchain indexed on transactions, blocks and addresses.
Querying for non-indexed data on the blockchain can be considered inefficient and to be avoided.
For efficient queryability of application specific entities on the blockchain, a tagging mechanism based on the indexed propeties can be used.

\section{Deterministic tagged address}
Blockchain addresses are typically created by hashing the public key of a public/private keypair.
To generate secure addresses it is recommended to use a strong random number as a private key.
However, as long as little or no funds are transferred to an address, there is no need for the address to be secure to teft.
Therefore private keys obtained by hashing a publicly known string can generate what we call a deterministic tagged address.

As an example, the command below demonstrates how a tagged address for tag ``my tag'' on the bitcoin network can be created using ``bitcoin-tool'' \_ref\_bitcoin-tool.
\begin{verbatim}
$ bitcoin-tool --input-type private-key
               --input-format hex
               --output-format base58check
               --network bitcoin
               --output-type address
               --public-key-compression compressed
               --input $(echo "my tag" | openssl sha256 | tail -c 65)
194aYsKYk7nF8Lf7Dak4vQaDg85wqPDy1g
\end{verbatim}

\section{Tagging transactions}
Tagging a transaction is done by adding a Pay-to-PubkeyHash transaction with the minimum transaction value to the transaction outputs.
Altough indistinguisable from a standard Pay-to-PubkeyHash output, we refer to these outputs as Pay-to-TagAddress or P2TA in short.

As an example, the code below creates a tagged transaction using bitcoin's JSON-RPC api.
\begin{verbatim}
TODO
\end{verbatim}


\section{Querying tagged transactions}

\section{Use case}

\section{Conclusion}


\begin{thebibliography}{9}

\bibitem{Ros12}
  Meni Rosenfeld,
  \emph{Overview of Colored Coins},
  December 4, 2012,
  \url{https://bitcoil.co.il/BitcoinX.pdf}

\bibitem{Emeth}
  Emeth,
  \emph{PeerMessage},
  \url{https://github.com/Peerapps/Peerapps/tree/master/peermessage}

\bibitem{Pchem}
  Peerchemist,
  \emph{PSA â€“ Peercoin simple assets},
  \url{https://mega.nz/#!GIdGwSjC!k9aLkRbXdx8Si0F3skdHy16D2T_GDaO8Evnedo5cYUA}

\bibitem{Nak09}
  Satoshi Nakamoto,
  \emph{Bitcoin: A Peer-to-Peer Electronic Cash System},
  \url{https://bitcoin.org/bitcoin.pdf}

\end{thebibliography}

\end{document}
